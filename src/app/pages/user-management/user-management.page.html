<ion-content [scrollY]="true">
  <div class="screen">
    <section class="container">
      <ion-card class="info-card">
        <ion-card-header>
          <ion-card-title>
            <ion-icon name="shield-checkmark" class="card-icon"></ion-icon>
            Administración de Roles
          </ion-card-title>
        </ion-card-header>
        <ion-card-content>
          <p>Gestiona los roles de los usuarios del sistema. Solo los administradores pueden acceder a esta sección.</p>
        </ion-card-content>
      </ion-card>

      <div class="search-container">
        <ion-searchbar
          [(ngModel)]="searchQuery"
          (ionInput)="onSearchChange($event)"
          placeholder="Buscar usuarios por nombre, email o usuario..."
          debounce="300"
          class="custom-searchbar">
        </ion-searchbar>
        <ion-button fill="clear" (click)="refreshUsers()" class="refresh-button">
          <ion-icon name="refresh" slot="icon-only"></ion-icon>
        </ion-button>
      </div>

      <div class="users-list">
        <ion-card *ngFor="let user of filteredUsers" class="user-card" [class.admin-card]="user.role === 'admin'">
          <ion-card-content>
            <div class="user-content">
              <div class="user-info">
                <div class="user-avatar" [class.admin-avatar]="user.role === 'admin'">
                  <ion-icon name="person" [color]="getRoleColor(user.role)"></ion-icon>
                </div>
                <div class="user-details">
                  <h2 class="user-name">{{ user.name }} {{ user.lastName }}</h2>
                  <div class="user-meta">
                    <ion-icon name="mail-outline" class="meta-icon"></ion-icon>
                    <span class="user-email">{{ user.email }}</span>
                  </div>
                  <div class="user-meta">
                    <ion-icon name="person-outline" class="meta-icon"></ion-icon>
                    <span class="user-username">@{{ user.user }}</span>
                  </div>
                </div>
              </div>
              <div class="role-section">
                <ion-badge [color]="getRoleColor(user.role)" class="role-badge">
                  {{ getRoleLabel(user.role) }}
                </ion-badge>
                <ion-select
                  [value]="user.role"
                  (ionChange)="onRoleChange(user, $event)"
                  interface="action-sheet"
                  [disabled]="isSelectDisabled(user)"
                  class="role-select">
                  <ion-select-option value="user">Usuario</ion-select-option>
                  <ion-select-option value="admin">Administrador</ion-select-option>
                </ion-select>
              </div>
            </div>
          </ion-card-content>
        </ion-card>
      </div>

      <div *ngIf="filteredUsers.length === 0" class="empty-state">
        <ion-icon name="search-outline" class="empty-icon"></ion-icon>
        <h2>No se encontraron usuarios</h2>
        <p>Intenta con otros términos de búsqueda</p>
      </div>
    </section>
  </div>
</ion-content>

